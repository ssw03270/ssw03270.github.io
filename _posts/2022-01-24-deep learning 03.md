---

layout: post
title: 딥러닝 공부 3일차

---

> 졸려

-----

# 3. Python & Vectorization

## Broadcasting in Python

broadcasting에 관한 부분을 굳이 적어야 될까 고민을 했다. 그래도 모든 강의를 정리하기로 했으니 일단 적어보려고 한다.

python에서 broadcasting이란 행렬 연산에서 행렬의 길이가 맞지 않을 때, 강제로 맞춰주는 것을 말한다.

![image](https://user-images.githubusercontent.com/62225673/150763217-a2508d8b-8c39-4655-ba1f-f85be9f8a69e.png)

예를 들어 위와 같은 연산을 수행해야 된다고 가정해보자. 왼쪽의 행렬은 4 * 1 행렬이고 오른쪽은 그냥 실수다. 현실에서 위와 같은 연산을 수행하고자 한다면 올바르지 않은 연산으로 여겨질 것이다. 그러나 python은 길이가 부족한 부분을 알아서 채워준다.

편의상 우측 행렬을 [1, 2, 3, 4] 라고 표현하겠다. 보는 바와 같이 이 행렬은 4 * 1 행렬이다. 그리고 오른쪽은 실수다. python은 이럴 때, 우측의 100을 [100, 100, 100, 100] 으로 바꿔준다. 이를 broadcasting 이라고 한다. 이런 과정을 통해 python은 위 연산을 올바르게 수행하며 [101, 102, 103, 104] 라고 답을 알려준다.

이는 이전에 편향을 더할 때도 이용되었다. 신경망을 구현하기 위해 중요하다고 하니 알아두자.

-----

## A Note on Python/Numpy Vectors

python의 행렬 계산은 생각보다 이상하다. 이는 계산을 편리하게 해주기 위함이지만 현실과 다른 점에서 혼동을 야기시킨다.

![image](https://user-images.githubusercontent.com/62225673/150765422-f5d93fbb-7d40-43a9-95f6-a6faadf975a5.png)

그 예로 위와 같은 행렬을 만들었다고 해보자. 행렬 a에 a의 전치 행렬을 외적한다고 생각해보자. 그러면 우리는 하나의 행렬이 나올 것이라 생각하겠지만 실상은 실수 하나만 달랑 나온다. 엔드류 응 교수는 (n,) 처럼 랭크가 1인 행렬을 사용하지 않는 것을 추천한다고 한다.

![image](https://user-images.githubusercontent.com/62225673/150765957-9f239723-95dd-4005-b432-c81b5a885697.png)

그러면 이런 문제를 어떻게 해결해야 될까. 위와 같이 행렬의 크기를 전부 지정해서 만들어주면 된다. 그러면 대괄호가 두 개에 감싸이는 것을 볼 수 있는데 이제 정상적인 행렬 연산이 가능해진다.

추가로 assert 함수를 넣어줘서 실수를 방지하자.

-----

## Explanation of Logistic Regression's Cost Function

logistic regression의 cost function에 대한 추가적인 부분이다. 이전에 설명한 cost function은 아래와 같은 형태를 취한다. 이러한 형태를 취하는 이유를 설명하도록 하겠다.

- (y * log(예측한 y) + (1 - y) * log(1 - 예측한 y))

![image](https://user-images.githubusercontent.com/62225673/150785231-5a155ee0-8034-43f7-b396-2ad6615a890d.png)

주어진 y가 0이나 1일 때에 따라 두 가지 공식으로 나뉘게 된다. 우리는 이를 하나의 식으로 나타내서 사용하고 싶다. 이를 위해 y가 0 혹은 1 밖에 주어지지 않는 특성을 이용한다.

![image](https://user-images.githubusercontent.com/62225673/150785375-a6422207-3a17-487e-9439-a6a08bf4c077.png)

위와 같이 식을 적으면 y가 1이면 예측된 y가 남고, y가 0이면 1- 예측된 y가 남는다. 이렇게 구해진 함수 P를 단조 증가 함수인 log로 감싼다. 단조 함수란 주어진 순서를 보존하는 함수로 기하적으로 봤을 때 왼쪽에서 오른쪽으로 줄곧 상승 혹은 하강하는 형태인 함수다.

> 이유를 모르겠다. 단조적인 성질과 log가 무슨 연관이 있는지. 이 부분은 조금 더 조사가 필요할 듯 하다.

또한 -1을 곱해 